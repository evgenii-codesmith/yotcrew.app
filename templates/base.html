<!DOCTYPE html>
<html lang="en" data-theme="cupcake">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>{% block title %}YotCrew.app{% endblock %}</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg">
    <link rel="icon" type="image/x-icon" href="/static/favicon.svg">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- DaisyUI 4.x for better CDN compatibility -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" type="text/css" />
    
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.9"></script>
    
    <!-- Alpine.js -->
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <style>
        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>

    <!-- Global Alpine.js Components for HTMX partials -->
    <script>
        // Global Alpine.js components available to all templates and partials
        document.addEventListener('alpine:init', () => {
            console.log('üéø Alpine.js initializing global components...');
            
            // Job Grid Component (for job cards)
            Alpine.data('jobGrid', () => {
                console.log('üõ•Ô∏è Creating jobGrid component');
                return {
                    selectedJobs: [],
                    
                    // Yacht images collection for job cards
                    yachtImages: [
                        {
                            id: 1,
                            url: "https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=200&fit=crop&crop=center",
                            alt: "Luxury Superyacht Side View"
                        },
                        {
                            id: 2,
                            url: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht in Marina"
                        },
                        {
                            id: 3,
                            url: "https://images.unsplash.com/photo-1582967788606-a171c1080cb0?w=400&h=200&fit=crop&crop=center",
                            alt: "Modern Superyacht Bow View"
                        },
                        {
                            id: 4,
                            url: "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Stern View"
                        },
                        {
                            id: 5,
                            url: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=200&fit=crop&crop=center",
                            alt: "White Superyacht Profile"
                        },
                        {
                            id: 6,
                            url: "https://images.unsplash.com/photo-1615781222256-cd404c71eb9e?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht at Sunset"
                        },
                        {
                            id: 7,
                            url: "https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=400&h=200&fit=crop&crop=center",
                            alt: "Classic Motor Superyacht"
                        },
                        {
                            id: 8,
                            url: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Aerial View"
                        },
                        {
                            id: 9,
                            url: "https://images.unsplash.com/photo-1517101216274-0a676e44e4bd?w=400&h=200&fit=crop&crop=center",
                            alt: "Luxury Yacht Front Angle"
                        },
                        {
                            id: 10,
                            url: "https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=400&h=200&fit=crop&crop=center",
                            alt: "Mega Yacht Side Profile"
                        },
                        {
                            id: 11,
                            url: "https://images.unsplash.com/photo-1600298881974-6be191ceeda1?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Harbor View"
                        },
                        {
                            id: 12,
                            url: "https://images.unsplash.com/photo-1600298882047-7a4db16b37bb?w=400&h=200&fit=crop&crop=center",
                            alt: "White Superyacht Docked"
                        },
                        {
                            id: 13,
                            url: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Low Angle"
                        },
                        {
                            id: 14,
                            url: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=200&fit=crop&crop=center",
                            alt: "Modern Yacht Design"
                        },
                        {
                            id: 15,
                            url: "https://images.unsplash.com/photo-1567899378494-47b22a2ae96a?w=400&h=200&fit=crop&crop=center",
                            alt: "Sleek Superyacht"
                        },
                        {
                            id: 16,
                            url: "https://images.unsplash.com/photo-1600298881428-5c0f2a0b5173?w=400&h=200&fit=crop&crop=center",
                            alt: "Luxury Yacht Quarter View"
                        },
                        {
                            id: 17,
                            url: "https://images.unsplash.com/photo-1597149379073-e9a3c9fd5f65?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Ocean View"
                        },
                        {
                            id: 18,
                            url: "https://images.unsplash.com/photo-1626897530052-0a28ad2f1237?w=400&h=200&fit=crop&crop=center",
                            alt: "Motor Yacht Port Side"
                        },
                        {
                            id: 19,
                            url: "https://images.unsplash.com/photo-1600195077909-3b42abfcddef?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht High Angle"
                        },
                        {
                            id: 20,
                            url: "https://images.unsplash.com/photo-1600195078299-a7de86e7dee8?w=400&h=200&fit=crop&crop=center",
                            alt: "Yacht Starboard View"
                        },
                        {
                            id: 21,
                            url: "https://images.unsplash.com/photo-1589810635657-84caf286b8ea?w=400&h=200&fit=crop&crop=center",
                            alt: "Superyacht Bridge View"
                        },
                        {
                            id: 22,
                            url: "https://images.unsplash.com/photo-1600298881974-6be191ceeda1?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.3&fp-y=0.6",
                            alt: "Yacht Marina Angle"
                        },
                        {
                            id: 23,
                            url: "https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.7&fp-y=0.4",
                            alt: "Superyacht Close-up"
                        },
                        {
                            id: 24,
                            url: "https://images.unsplash.com/photo-1626897530052-0a28ad2f1237?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.5&fp-y=0.3",
                            alt: "Luxury Yacht Detail"
                        },
                        {
                            id: 25,
                            url: "https://images.unsplash.com/photo-1600195077909-3b42abfcddef?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.6&fp-y=0.7",
                            alt: "Mega Yacht Perspective"
                        },
                        {
                            id: 26,
                            url: "https://images.unsplash.com/photo-1567899378494-47b22a2ae96a?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.4&fp-y=0.5",
                            alt: "Sport Yacht Profile"
                        },
                        {
                            id: 27,
                            url: "https://images.unsplash.com/photo-1597149379073-e9a3c9fd5f65?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.2&fp-y=0.6",
                            alt: "Ocean Superyacht"
                        },
                        {
                            id: 28,
                            url: "https://images.unsplash.com/photo-1600195078299-a7de86e7dee8?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.8&fp-y=0.4",
                            alt: "Yacht Wide View"
                        },
                        {
                            id: 29,
                            url: "https://images.unsplash.com/photo-1589810635657-84caf286b8ea?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.3&fp-y=0.7",
                            alt: "Superyacht Deck View"
                        },
                        {
                            id: 30,
                            url: "https://images.unsplash.com/photo-1558618047-3c8c76ca7d13?w=400&h=200&fit=crop&crop=focalpoint&fp-x=0.6&fp-y=0.3",
                            alt: "Modern Superyacht"
                        }
                    ],
                    
                    getRandomYachtImage() {
                        const randomIndex = Math.floor(Math.random() * this.yachtImages.length);
                        const randomImage = this.yachtImages[randomIndex];
                        console.log('üé≤ Random yacht image selected:', randomImage);
                        return randomImage;
                    },
                    
                    updateSelection(jobId, isSelected) {
                        if (isSelected) {
                            if (!this.selectedJobs.includes(jobId)) {
                                this.selectedJobs.push(jobId);
                            }
                        } else {
                            this.selectedJobs = this.selectedJobs.filter(id => id !== jobId);
                        }
                    },
                    
                    clearSelection() {
                        this.selectedJobs = [];
                        // Clear all checkboxes
                        document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                    },
                    
                    compareJobs() {
                        alert(`Comparing ${this.selectedJobs.length} jobs: ${this.selectedJobs.join(', ')}`);
                    }
                };
            });
            
            // Individual Job Card Component
            Alpine.data('jobCard', (jobId, jobTitle, jobDescription) => {
                console.log('üÉè Creating jobCard component for:', jobId);
                return {
                    id: jobId,
                    title: jobTitle,
                    description: jobDescription,
                    expanded: false,
                    selected: false,
                    saved: false,
                    cardYachtImage: {
                        url: 'https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=200&fit=crop&crop=center',
                        alt: 'Luxury Yacht'
                    },
                    
                    init() {
                        // Get random yacht image for this card
                        console.log('üöÄ Initializing job card:', this.id);
                        this.refreshYachtImage();
                    },
                    
                    refreshYachtImage() {
                        // Get random yacht image from parent component
                        const parent = this.$parent;
                        console.log('üîÑ Refreshing yacht image for job:', this.id, 'Parent:', parent);
                        if (parent && parent.getRandomYachtImage) {
                            this.cardYachtImage = parent.getRandomYachtImage();
                            console.log('‚úÖ New image assigned:', this.cardYachtImage);
                        } else {
                            console.warn('‚ö†Ô∏è Parent or getRandomYachtImage not available, using fallback');
                            // Fallback: get random image directly
                            const images = [
                                {
                                    url: "https://images.unsplash.com/photo-1544551763-46a013bb70d5?w=400&h=200&fit=crop&crop=center",
                                    alt: "Luxury Motor Yacht"
                                },
                                {
                                    url: "https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=200&fit=crop&crop=center",
                                    alt: "Superyacht in Harbor"
                                },
                                {
                                    url: "https://images.unsplash.com/photo-1582967788606-a171c1080cb0?w=400&h=200&fit=crop&crop=center",
                                    alt: "Modern Sailing Yacht"
                                },
                                {
                                    url: "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=400&h=200&fit=crop&crop=center",
                                    alt: "Explorer Yacht"
                                },
                                {
                                    url: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=200&fit=crop&crop=center",
                                    alt: "Catamaran Superyacht"
                                }
                            ];
                            const randomIndex = Math.floor(Math.random() * images.length);
                            this.cardYachtImage = images[randomIndex];
                            console.log('üéØ Fallback image assigned:', this.cardYachtImage);
                        }
                    },
                    
                    toggleExpanded() {
                        this.expanded = !this.expanded;
                    },
                    
                    toggleSaved() {
                        this.saved = !this.saved;
                        console.log(`Job ${this.id} ${this.saved ? 'saved' : 'unsaved'}`);
                    },
                    
                    copyJobLink() {
                        const url = `${window.location.origin}/jobs/${this.id}`;
                        navigator.clipboard.writeText(url).then(() => {
                            console.log('Job link copied!');
                        });
                    },
                    
                    shareJob() {
                        if (navigator.share) {
                            navigator.share({
                                title: this.title,
                                text: this.description.substring(0, 100) + '...',
                                url: `${window.location.origin}/jobs/${this.id}`
                            });
                        } else {
                            this.copyJobLink();
                        }
                    },

                    handleImageError() {
                        console.warn(`‚ùå Image failed to load for job ${this.id}. Using fallback.`);
                        this.refreshYachtImage();
                    }
                };
            });
            
            console.log('‚úÖ Alpine.js global components registered successfully');
        });
    </script>
</head>

<body class="min-h-screen bg-base-200">

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Additional page-specific JavaScript -->
    {% block scripts %}{% endblock %}

    <script>
         // Set cupcake theme properly
         document.addEventListener('DOMContentLoaded', function() {
             document.documentElement.setAttribute('data-theme', 'cupcake');
             console.log('Cupcake theme set via DaisyUI data-theme attribute');
         });

    </script>
</body>
</html> 